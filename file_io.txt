Network메Working메Group메S.메Deering메,메Xerox메PARC메Request메for메Comments메:메1883메R.메Hinden메,메Ipsilon메Networks메Category메:메Standards메Track메December메1995메Internet메Protocol메,메Version메6메(메IPv6메)메Specification메Status메of메this메Memo메This메document메specifies메an메Internet메standards메track메protocol메for메the메Internet메community메,메and메requests메discussion메and메suggestions메for메improvements메.메Please메refer메to메the메current메edition메of메the메``메Internet메Official메Protocol메Standards메''메(메STD메1메)메for메the메standardization메state메and메status메of메this메protocol메.메Distribution메of메this메memo메is메unlimited메.메Abstract메This메document메specifies메version메6메of메the메Internet메Protocol메(메IPv6메)메,메also메sometimes메referred메to메as메IP메Next메Generation메or메IPng메.메Table메of메Contents메1메.메Introduction메..................................................메3메2메.메Terminology메...................................................메4메3메.메IPv6메Header메Format메............................................메5메4메.메IPv6메Extension메Headers메........................................메6메4.1메Extension메Header메Order메...................................메8메4.2메Options메..................................................메9메4.3메Hop-by-Hop메Options메Header메...............................메11메4.4메Routing메Header메..........................................메13메4.5메Fragment메Header메.........................................메19메4.6메Destination메Options메Header메..............................메24메4.7메No메Next메Header메..........................................메25메5메.메Packet메Size메Issues메...........................................메26메6메.메Flow메Labels메..................................................메28메7메.메Priority메.....................................................메30메8메.메Upper-Layer메Protocol메Issues메..................................메31메8.1메Upper-Layer메Checksums메...................................메31메8.2메Maximum메Packet메Lifetime메.................................메32메8.3메Maximum메Upper-Layer메Payload메Size메........................메32메Appendix메A.메Formatting메Guidelines메for메Options메...................메33메Security메Considerations메.........................................메36메Acknowledgments메.................................................메36메Authors메'메Addresses메..............................................메36메References메......................................................메37메1메.메Introduction메IP메version메6메(메IPv6메)메is메a메new메version메of메the메Internet메Protocol메,메designed메as메a메successor메to메IP메version메4메(메IPv4메)메[메RFC-791메]메.메The메changes메from메IPv4메to메IPv6메fall메primarily메into메the메following메categories메:메o메Expanded메Addressing메Capabilities메IPv6메increases메the메IP메address메size메from메32메bits메to메128메bits메,메to메support메more메levels메of메addressing메hierarchy메,메a메much메greater메number메of메addressable메nodes메,메and메simpler메auto-configuration메of메addresses메.메The메scalability메of메multicast메routing메is메improved메by메adding메a메``메scope메''메field메to메multicast메addresses메.메And메a메new메type메of메address메called메an메``메anycast메address메''메is메defined메,메used메to메send메a메packet메to메any메one메of메a메group메of메nodes메.메o메Header메Format메Simplification메Some메IPv4메header메fields메have메been메dropped메or메made메optional메,메to메reduce메the메common-case메processing메cost메of메packet메handling메and메to메limit메the메bandwidth메cost메of메the메IPv6메header메.메o메Improved메Support메for메Extensions메and메Options메Changes메in메the메way메IP메header메options메are메encoded메allows메for메more메efficient메forwarding메,메less메stringent메limits메on메the메length메of메options메,메and메greater메flexibility메for메introducing메new메options메in메the메future메.메o메Flow메Labeling메Capability메A메new메capability메is메added메to메enable메the메labeling메of메packets메belonging메to메particular메traffic메``메flows메''메for메which메the메sender메requests메special메handling메,메such메as메non-default메quality메of메service메or메``메real-time메''메service메.메o메Authentication메and메Privacy메Capabilities메Extensions메to메support메authentication메,메data메integrity메,메and메(메optional메)메data메confidentiality메are메specified메for메IPv6메.메This메document메specifies메the메basic메IPv6메header메and메the메initially-메defined메IPv6메extension메headers메and메options메.메It메also메discusses메packet메size메issues메,메the메semantics메of메flow메labels메and메priority메,메and메the메effects메of메IPv6메on메upper-layer메protocols메.메The메format메and메semantics메of메IPv6메addresses메are메specified메separately메in메[메RFC-1884메]메.메The메IPv6메version메of메ICMP메,메which메all메IPv6메implementations메are메required메to메include메,메is메specified메in메[메RFC-1885메]메.메2메.메Terminology메node메-메a메device메that메implements메IPv6메.메router메-메a메node메that메forwards메IPv6메packets메not메explicitly메addressed메to메itself메.메[메See메Note메below메]메.메host메-메any메node메that메is메not메a메router메.메[메See메Note메below메]메.메upper메layer메-메a메protocol메layer메immediately메above메IPv6메.메Examples메are메transport메protocols메such메as메TCP메and메UDP메,메control메protocols메such메as메ICMP메,메routing메protocols메such메as메OSPF메,메and메internet메or메lower-layer메protocols메being메``메tunneled메''메over메(메i.e.메,메encapsulated메in메)메IPv6메such메as메IPX메,메AppleTalk메,메or메IPv6메itself메.메link메-메a메communication메facility메or메medium메over메which메nodes메can메communicate메at메the메link메layer메,메i.e.메,메the메layer메immediately메below메IPv6메.메Examples메are메Ethernets메(메simple메or메bridged메)메;메PPP메links메;메X.25메,메Frame메Relay메,메or메ATM메networks메;메and메internet메(메or메higher메)메layer메``메tunnels메''메,메such메as메tunnels메over메IPv4메or메IPv6메itself메.메neighbors메-메nodes메attached메to메the메same메link메.메interface메-메a메node메's메attachment메to메a메link메.메address메-메an메IPv6-layer메identifier메for메an메interface메or메a메set메of메interfaces메.메packet메-메an메IPv6메header메plus메payload메.메link메MTU메-메the메maximum메transmission메unit메,메i.e.메,메maximum메packet메size메in메octets메,메that메can메be메conveyed메in메one메piece메over메a메link메.메path메MTU메-메the메minimum메link메MTU메of메all메the메links메in메a메path메between메a메source메node메and메a메destination메node메.메Note메:메it메is메possible메,메though메unusual메,메for메a메device메with메multiple메interfaces메to메be메configured메to메forward메non-self-destined메packets메arriving메from메some메set메(메fewer메than메all메)메of메its메interfaces메,메and메to메discard메non-self-destined메packets메arriving메from메its메other메interfaces메.메Such메a메device메must메obey메the메protocol메requirements메for메routers메when메receiving메packets메from메,메and메interacting메with메neighbors메over메,메the메former메(메forwarding메)메interfaces메.메It메must메obey메the메protocol메requirements메for메hosts메when메receiving메packets메from메,메and메interacting메with메neighbors메over메,메the메latter메(메non-forwarding메)메interfaces메.메3메.메IPv6메Header메Format메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|Version|메Prio메.메|메Flow메Label메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Payload메Length메|메Next메Header메|메Hop메Limit메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Source메Address메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Destination메Address메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Version메4-bit메Internet메Protocol메version메number메=메6메.메Prio메.메4-bit메priority메value메.메See메section메7메.메Flow메Label메24-bit메flow메label메.메See메section메6메.메Payload메Length메16-bit메unsigned메integer메.메Length메of메payload메,메i.e.메,메the메rest메of메the메packet메following메the메IPv6메header메,메in메octets메.메If메zero메,메indicates메that메the메payload메length메is메carried메in메a메Jumbo메Payload메hop-by-hop메option메.메Next메Header메8-bit메selector메.메Identifies메the메type메of메header메immediately메following메the메IPv6메header메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Hop메Limit메8-bit메unsigned메integer메.메Decremented메by메1메by메each메node메that메forwards메the메packet메.메The메packet메is메discarded메if메Hop메Limit메is메decremented메to메zero메.메Source메Address메128-bit메address메of메the메originator메of메the메packet메.메See메[메RFC-1884메]메.메Destination메Address메128-bit메address메of메the메intended메recipient메of메the메packet메(메possibly메not메the메ultimate메recipient메,메if메a메Routing메header메is메present메)메.메See메[메RFC-1884메]메and메section메4.4메.메4메.메IPv6메Extension메Headers메In메IPv6메,메optional메internet-layer메information메is메encoded메in메separate메headers메that메may메be메placed메between메the메IPv6메header메and메the메upper-메layer메header메in메a메packet메.메There메are메a메small메number메of메such메extension메headers메,메each메identified메by메a메distinct메Next메Header메value메.메As메illustrated메in메these메examples메,메an메IPv6메packet메may메carry메zero메,메one메,메or메more메extension메headers메,메each메identified메by메the메Next메Header메field메of메the메preceding메header메:메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메--메--메--메--메|메IPv6메header메|메TCP메header메+메data메|메|메|메Next메Header메=메|메|메TCP메|메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메--메|메IPv6메header메|메Routing메header메|메TCP메header메+메data메|메|메|메|메Next메Header메=메|메Next메Header메=메|메|메Routing메|메TCP메|메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메-메|메IPv6메header메|메Routing메header메|메Fragment메header메|메fragment메of메TCP메|메|메|메|메header메+메data메|메Next메Header메=메|메Next메Header메=메|메Next메Header메=메|메|메Routing메|메Fragment메|메TCP메|메+메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메-+메--메--메--메--메--메--메--메--메-메With메one메exception메,메extension메headers메are메not메examined메or메processed메by메any메node메along메a메packet메's메delivery메path메,메until메the메packet메reaches메the메node메(메or메each메of메the메set메of메nodes메,메in메the메case메of메multicast메)메identified메in메the메Destination메Address메field메of메the메IPv6메header메.메There메,메normal메demultiplexing메on메the메Next메Header메field메of메the메IPv6메header메invokes메the메module메to메process메the메first메extension메header메,메or메the메upper-layer메header메if메no메extension메header메is메present메.메The메contents메and메semantics메of메each메extension메header메determine메whether메or메not메to메proceed메to메the메next메header메.메Therefore메,메extension메headers메must메be메processed메strictly메in메the메order메they메appear메in메the메packet메;메a메receiver메must메not메,메for메example메,메scan메through메a메packet메looking메for메a메particular메kind메of메extension메header메and메process메that메header메prior메to메processing메all메preceding메ones메.메The메exception메referred메to메in메the메preceding메paragraph메is메the메Hop-by-메Hop메Options메header메,메which메carries메information메that메must메be메examined메and메processed메by메every메node메along메a메packet메's메delivery메path메,메including메the메source메and메destination메nodes메.메The메Hop-by-Hop메Options메header메,메when메present메,메must메immediately메follow메the메IPv6메header메.메Its메presence메is메indicated메by메the메value메zero메in메the메Next메Header메field메of메the메IPv6메header메.메If메,메as메a메result메of메processing메a메header메,메a메node메is메required메to메proceed메to메the메next메header메but메the메Next메Header메value메in메the메current메header메is메unrecognized메by메the메node메,메it메should메discard메the메packet메and메send메an메ICMP메Parameter메Problem메message메to메the메source메of메the메packet메,메with메an메ICMP메Code메value메of메2메(메``메unrecognized메Next메Header메type메encountered메''메)메and메the메ICMP메Pointer메field메containing메the메offset메of메the메unrecognized메value메within메the메original메packet메.메The메same메action메should메be메taken메if메a메node메encounters메a메Next메Header메value메of메zero메in메any메header메other메than메an메IPv6메header메.메Each메extension메header메is메an메integer메multiple메of메8메octets메long메,메in메order메to메retain메8-octet메alignment메for메subsequent메headers메.메Multi-메octet메fields메within메each메extension메header메are메aligned메on메their메natural메boundaries메,메i.e.메,메fields메of메width메n메octets메are메placed메at메an메integer메multiple메of메n메octets메from메the메start메of메the메header메,메for메n메=메1메,메2메,메4메,메or메8메.메A메full메implementation메of메IPv6메includes메implementation메of메the메following메extension메headers메:메Hop-by-Hop메Options메Routing메(메Type메0메)메Fragment메Destination메Options메Authentication메Encapsulating메Security메Payload메The메first메four메are메specified메in메this메document메;메the메last메two메are메specified메in메[메RFC-1826메]메and메[메RFC-1827메]메,메respectively메.메4.1메Extension메Header메Order메When메more메than메one메extension메header메is메used메in메the메same메packet메,메it메is메recommended메that메those메headers메appear메in메the메following메order메:메IPv6메header메Hop-by-Hop메Options메header메Destination메Options메header메(메note메1메)메Routing메header메Fragment메header메Authentication메header메(메note메2메)메Encapsulating메Security메Payload메header메(메note메2메)메Destination메Options메header메(메note메3메)메upper-layer메header메note메1메:메for메options메to메be메processed메by메the메first메destination메that메appears메in메the메IPv6메Destination메Address메field메plus메subsequent메destinations메listed메in메the메Routing메header메.메note메2메:메additional메recommendations메regarding메the메relative메order메of메the메Authentication메and메Encapsulating메Security메Payload메headers메are메given메in메[메RFC-1827메]메.메note메3메:메for메options메to메be메processed메only메by메the메final메destination메of메the메packet메.메Each메extension메header메should메occur메at메most메once메,메except메for메the메Destination메Options메header메which메should메occur메at메most메twice메(메once메before메a메Routing메header메and메once메before메the메upper-layer메header메)메.메If메the메upper-layer메header메is메another메IPv6메header메(메in메the메case메of메IPv6메being메tunneled메over메or메encapsulated메in메IPv6메)메,메it메may메be메followed메by메its메own메extensions메headers메,메which메are메separately메subject메to메the메same메ordering메recommendations메.메If메and메when메other메extension메headers메are메defined메,메their메ordering메constraints메relative메to메the메above메listed메headers메must메be메specified메.메IPv6메nodes메must메accept메and메attempt메to메process메extension메headers메in메any메order메and메occurring메any메number메of메times메in메the메same메packet메,메except메for메the메Hop-by-Hop메Options메header메which메is메restricted메to메appear메immediately메after메an메IPv6메header메only메.메Nonetheless메,메it메is메strongly메advised메that메sources메of메IPv6메packets메adhere메to메the메above메recommended메order메until메and메unless메subsequent메specifications메revise메that메recommendation메.메4.2메Options메Two메of메the메currently-defined메extension메headers메--메the메Hop-by-Hop메Options메header메and메the메Destination메Options메header메--메carry메a메variable메number메of메type-length-value메(메TLV메)메encoded메``메options메''메,메of메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-메-메-메-메-메-메-메-메-메|메Option메Type메|메Opt메Data메Len메|메Option메Data메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-메-메-메-메-메-메-메-메-메Option메Type메8-bit메identifier메of메the메type메of메option메.메Opt메Data메Len메8-bit메unsigned메integer메.메Length메of메the메Option메Data메field메of메this메option메,메in메octets메.메Option메Data메Variable-length메field메.메Option-Type-specific메data메.메The메sequence메of메options메within메a메header메must메be메processed메strictly메in메the메order메they메appear메in메the메header메;메a메receiver메must메not메,메for메example메,메scan메through메the메header메looking메for메a메particular메kind메of메option메and메process메that메option메prior메to메processing메all메preceding메ones메.메The메Option메Type메identifiers메are메internally메encoded메such메that메their메highest-order메two메bits메specify메the메action메that메must메be메taken메if메the메processing메IPv6메node메does메not메recognize메the메Option메Type메:메00메-메skip메over메this메option메and메continue메processing메the메header메.메01메-메discard메the메packet메.메10메-메discard메the메packet메and메,메regardless메of메whether메or메not메the메packets메's메Destination메Address메was메a메multicast메address메,메send메an메ICMP메Parameter메Problem메,메Code메2메,메message메to메the메packet's메Source메Address메,메pointing메to메the메unrecognized메Option메Type메.메11메-메discard메the메packet메and메,메only메if메the메packet메's메Destination메Address메was메not메a메multicast메address메,메send메an메ICMP메Parameter메Problem메,메Code메2메,메message메to메the메packet메's메Source메Address메,메pointing메to메the메unrecognized메Option메Type메.메The메third-highest-order메bit메of메the메Option메Type메specifies메whether메or메not메the메Option메Data메of메that메option메can메change메en-route메to메the메packet메's메final메destination메.메When메an메Authentication메header메is메present메in메the메packet메,메for메any메option메whose메data메may메change메en-route메,메its메entire메Option메Data메field메must메be메treated메as메zero-valued메octets메when메computing메or메verifying메the메packet메's메authenticating메value메.메0메-메Option메Data메does메not메change메en-route메1메-메Option메Data메may메change메en-route메Individual메options메may메have메specific메alignment메requirements메,메to메ensure메that메multi-octet메values메within메Option메Data메fields메fall메on메natural메boundaries메.메The메alignment메requirement메of메an메option메is메specified메using메the메notation메xn+y메,메meaning메the메Option메Type메must메appear메at메an메integer메multiple메of메x메octets메from메the메start메of메the메header메,메plus메y메octets메.메For메example메:메2n메means메any메2-octet메offset메from메the메start메of메the메header메.메8n+2메means메any메8-octet메offset메from메the메start메of메the메header메,메plus메2메octets메.메There메are메two메padding메options메which메are메used메when메necessary메to메align메subsequent메options메and메to메pad메out메the메containing메header메to메a메multiple메of메8메octets메in메length메.메These메padding메options메must메be메recognized메by메all메IPv6메implementations메:메Pad1메option메(메alignment메requirement메:메none메)메+-+-+-+-+-+-+-+-+메|메0메|메+-+-+-+-+-+-+-+-+메NOTE메!메the메format메of메the메Pad1메option메is메a메special메case메--메it메does메not메have메length메and메value메fields메.메The메Pad1메option메is메used메to메insert메one메octet메of메padding메into메the메Options메area메of메a메header메.메If메more메than메one메octet메of메padding메is메required메,메the메PadN메option메,메described메next메,메should메be메used메,메rather메than메multiple메Pad1메options메.메PadN메option메(메alignment메requirement메:메none메)메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-메-메-메-메-메-메-메-메-메|메1메|메Opt메Data메Len메|메Option메Data메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-메-메-메-메-메-메-메-메-메The메PadN메option메is메used메to메insert메two메or메more메octets메of메padding메into메the메Options메area메of메a메header메.메For메N메octets메of메padding메,메the메Opt메Data메Len메field메contains메the메value메N-2메,메and메the메Option메Data메consists메of메N-2메zero-valued메octets메.메Appendix메A메contains메formatting메guidelines메for메designing메new메options메.메4.3메Hop-by-Hop메Options메Header메The메Hop-by-Hop메Options메header메is메used메to메carry메optional메information메that메must메be메examined메by메every메node메along메a메packet메's메delivery메path메.메The메Hop-by-Hop메Options메header메is메identified메by메a메Next메Header메value메of메0메in메the메IPv6메header메,메and메has메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메+메|메|메.메.메.메Options메.메.메.메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Next메Header메8-bit메selector메.메Identifies메the메type메of메header메immediately메following메the메Hop-by-Hop메Options메header메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Hdr메Ext메Len메8-bit메unsigned메integer메.메Length메of메the메Hop-by-Hop메Options메header메in메8-octet메units메,메not메including메the메first메8메octets메.메Options메Variable-length메field메,메of메length메such메that메the메complete메Hop-by-Hop메Options메header메is메an메integer메multiple메of메8메octets메long메.메Contains메one메or메more메TLV-encoded메options메,메as메described메in메section메4.2메.메In메addition메to메the메Pad1메and메PadN메options메specified메in메section메4.2메,메the메following메hop-by-hop메option메is메defined메:메Jumbo메Payload메option메(메alignment메requirement메:메4n메+메2메)메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메194메|Opt메Data메Len=4메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Jumbo메Payload메Length메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메The메Jumbo메Payload메option메is메used메to메send메IPv6메packets메with메payloads메longer메than메65,535메octets메.메The메Jumbo메Payload메Length메is메the메length메of메the메packet메in메octets메,메excluding메the메IPv6메header메but메including메the메Hop-by-Hop메Options메header메;메it메must메be메greater메than메65,535메.메If메a메packet메is메received메with메a메Jumbo메Payload메option메containing메a메Jumbo메Payload메Length메less메than메or메equal메to메65,535메,메an메ICMP메Parameter메Problem메message메,메Code메0메,메should메be메sent메to메the메packet메's메source메,메pointing메to메the메high-order메octet메of메the메invalid메Jumbo메Payload메Length메field메.메The메Payload메Length메field메in메the메IPv6메header메must메be메set메to메zero메in메every메packet메that메carries메the메Jumbo메Payload메option메.메If메a메packet메is메received메with메a메valid메Jumbo메Payload메option메present메and메a메non-zero메IPv6메Payload메Length메field메,메an메ICMP메Parameter메Problem메message메,메Code메0메,메should메be메sent메to메the메packet메's메source메,메pointing메to메the메Option메Type메field메of메the메Jumbo메Payload메option메.메The메Jumbo메Payload메option메must메not메be메used메in메a메packet메that메carries메a메Fragment메header메.메If메a메Fragment메header메is메encountered메in메a메packet메that메contains메a메valid메Jumbo메Payload메option메,메an메ICMP메Parameter메Problem메message메,메Code메0메,메should메be메sent메to메the메packet's메source메,메pointing메to메the메first메octet메of메the메Fragment메header메.메An메implementation메that메does메not메support메the메Jumbo메Payload메option메can메not메have메interfaces메to메links메whose메link메MTU메is메greater메than메65,575메(메40메octets메of메IPv6메header메plus메65,535메octets메of메payload메)메.메4.4메Routing메Header메The메Routing메header메is메used메by메an메IPv6메source메to메list메one메or메more메intermediate메nodes메to메be메``메visited메''메on메the메way메to메a메packet's메destination메.메This메function메is메very메similar메to메IPv4메's메Source메Route메options메.메The메Routing메header메is메identified메by메a메Next메Header메value메of메43메in메the메immediately메preceding메header메,메and메has메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len메|메Routing메Type메|메Segments메Left메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메.메.메.메type-specific메data메.메.메.메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Next메Header메8-bit메selector메.메Identifies메the메type메of메header메immediately메following메the메Routing메header메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Hdr메Ext메Len메8-bit메unsigned메integer메.메Length메of메the메Routing메header메in메8-octet메units메,메not메including메the메first메8메octets메.메Routing메Type메8-bit메identifier메of메a메particular메Routing메header메variant메.메Segments메Left메8-bit메unsigned메integer메.메Number메of메route메segments메remaining메,메i.e.메,메number메of메explicitly메listed메intermediate메nodes메still메to메be메visited메before메reaching메the메final메destination메.메type-specific메data메Variable-length메field메,메of메format메determined메by메the메Routing메Type메,메and메of메length메such메that메the메complete메Routing메header메is메an메integer메multiple메of메8메octets메long메.메If메,메while메processing메a메received메packet메,메a메node메encounters메a메Routing메header메with메an메unrecognized메Routing메Type메value메,메the메required메behavior메of메the메node메depends메on메the메value메of메the메Segments메Left메field메,메as메follows메:메If메Segments메Left메is메zero메,메the메node메must메ignore메the메Routing메header메and메proceed메to메process메the메next메header메in메the메packet메,메whose메type메is메identified메by메the메Next메Header메field메in메the메Routing메header메.메If메Segments메Left메is메non-zero메,메the메node메must메discard메the메packet메and메send메an메ICMP메Parameter메Problem메,메Code메0메,메message메to메the메packet's메Source메Address메,메pointing메to메the메unrecognized메Routing메Type메.메The메Type메0메Routing메header메has메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len메|메Routing메Type=0|메Segments메Left메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Reserved메|메Strict/Loose메Bit메Map메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Address메[메1메]메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Address메[메2메]메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메.메.메.메.메.메.메.메.메.메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Address메[메n메]메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Next메Header메8-bit메selector메.메Identifies메the메type메of메header메immediately메following메the메Routing메header메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Hdr메Ext메Len메8-bit메unsigned메integer메.메Length메of메the메Routing메header메in메8-octet메units메,메not메including메the메first메8메octets메.메For메the메Type메0메Routing메header메,메Hdr메Ext메Len메is메equal메to메two메times메the메number메of메addresses메in메the메header메,메and메must메be메an메even메number메less메than메or메equal메to메46메.메Routing메Type메0메.메Segments메Left메8-bit메unsigned메integer메.메Number메of메route메segments메remaining메,메i.e.메,메number메of메explicitly메listed메intermediate메nodes메still메to메be메visited메before메reaching메the메final메destination메.메Maximum메legal메value메=메23메.메Reserved메8-bit메reserved메field메.메Initialized메to메zero메for메transmission메;메ignored메on메reception메.메Strict/Loose메Bit메Map메24-bit메bit-map메,메numbered메0메to메23메,메left-to-right메.메Indicates메,메for메each메segment메of메the메route메,메whether메or메not메the메next메destination메address메must메be메a메neighbor메of메the메preceding메address메:메1메means메strict메(메must메be메a메neighbor메)메,메0메means메loose메(메need메not메be메a메neighbor메)메.메Address메[메1메..메n메]메Vector메of메128-bit메addresses메,메numbered메1메to메n.메Multicast메addresses메must메not메appear메in메a메Routing메header메of메Type메0메,메or메in메the메IPv6메Destination메Address메field메of메a메packet메carrying메a메Routing메header메of메Type메0메.메If메bit메number메0메of메the메Strict/Loose메Bit메Map메has메value메1메,메the메Destination메Address메field메of메the메IPv6메header메in메the메original메packet메must메identify메a메neighbor메of메the메originating메node메.메If메bit메number메0메has메value메0메,메the메originator메may메use메any메legal메,메non-multicast메address메as메the메initial메Destination메Address메.메Bits메numbered메greater메than메n메,메where메n메is메the메number메of메addresses메in메the메Routing메header메,메must메be메set메to메0메by메the메originator메and메ignored메by메receivers메.메A메Routing메header메is메not메examined메or메processed메until메it메reaches메the메node메identified메in메the메Destination메Address메field메of메the메IPv6메header메.메In메that메node메,메dispatching메on메the메Next메Header메field메of메the메immediately메preceding메header메causes메the메Routing메header메module메to메be메invoked메,메which메,메in메the메case메of메Routing메Type메0메,메performs메the메following메algorithm메:메if메Segments메Left메=메0메{메proceed메to메process메the메next메header메in메the메packet메,메whose메type메is메identified메by메the메Next메Header메field메in메the메Routing메header메}메else메if메Hdr메Ext메Len메is메odd메or메greater메than메46메{메send메an메ICMP메Parameter메Problem메,메Code메0메,메message메to메the메Source메Address메,메pointing메to메the메Hdr메Ext메Len메field메,메and메discard메the메packet메}메else메{메compute메n메,메the메number메of메addresses메in메the메Routing메header메,메by메dividing메Hdr메Ext메Len메by메2메if메Segments메Left메is메greater메than메n메{메send메an메ICMP메Parameter메Problem메,메Code메0메,메message메to메the메Source메Address메,메pointing메to메the메Segments메Left메field메,메and메discard메the메packet메}메else메{메decrement메Segments메Left메by메1메;메compute메i메,메the메index메of메the메next메address메to메be메visited메in메the메address메vector메,메by메subtracting메Segments메Left메from메n메if메Address메[메i메]메or메the메IPv6메Destination메Address메is메multicast메{메discard메the메packet메}메else메{메swap메the메IPv6메Destination메Address메and메Address메[메i메]메if메bit메i메of메the메Strict/Loose메Bit메map메has메value메1메and메the메new메Destination메Address메is메not메the메address메of메a메neighbor메of메this메node메{메send메an메ICMP메Destination메Unreachable메--메Not메a메Neighbor메message메to메the메Source메Address메and메discard메the메packet메}메else메if메the메IPv6메Hop메Limit메is메less메than메or메equal메to메1메{메send메an메ICMP메Time메Exceeded메--메Hop메Limit메Exceeded메in메Transit메message메to메the메Source메Address메and메discard메the메packet메}메else메{메decrement메the메Hop메Limit메by메1메resubmit메the메packet메to메the메IPv6메module메for메transmission메to메the메new메destination메}메}메}메}메As메an메example메of메the메effects메of메the메above메algorithm메,메consider메the메case메of메a메source메node메S메sending메a메packet메to메destination메node메D메,메using메a메Routing메header메to메cause메the메packet메to메be메routed메via메intermediate메nodes메I1메,메I2메,메and메I3메.메The메values메of메the메relevant메IPv6메header메and메Routing메header메fields메on메each메segment메of메the메delivery메path메would메be메as메follows메:메As메the메packet메travels메from메S메to메I1메:메Source메Address메=메S메Hdr메Ext메Len메=메6메Destination메Address메=메I1메Segments메Left메=메3메Address메[메1메]메=메I2메(메if메bit메0메of메the메Bit메Map메is메1메,메Address메[메2메]메=메I3메S메and메I1메must메be메neighbors메;메Address메[메3메]메=메D메this메is메checked메by메S메)메As메the메packet메travels메from메I1메to메I2메:메Source메Address메=메S메Hdr메Ext메Len메=메6메Destination메Address메=메I2메Segments메Left메=메2메Address메[메1메]메=메I1메(메if메bit메1메of메the메Bit메Map메is메1메,메Address메[메2메]메=메I3메I1메and메I2메must메be메neighbors메;메Address메[메3메]메=메D메this메is메checked메by메I1메)메As메the메packet메travels메from메I2메to메I3메:메Source메Address메=메S메Hdr메Ext메Len메=메6메Destination메Address메=메I3메Segments메Left메=메1메Address메[메1메]메=메I1메(메if메bit메2메of메the메Bit메Map메is메1메,메Address메[메2메]메=메I2메I2메and메I3메must메be메neighbors메;메Address메[메3메]메=메D메this메is메checked메by메I2메)메As메the메packet메travels메from메I3메to메D메:메Source메Address메=메S메Hdr메Ext메Len메=메6메Destination메Address메=메D메Segments메Left메=메0메Address메[메1메]메=메I1메(메if메bit메3메of메the메Bit메Map메is메1메,메Address메[메2메]메=메I2메I3메and메D메must메be메neighbors메;메Address메[메3메]메=메I3메this메is메checked메by메I3메)메4.5메Fragment메Header메The메Fragment메header메is메used메by메an메IPv6메source메to메send메packets메larger메than메would메fit메in메the메path메MTU메to메their메destinations메.메(메Note메:메unlike메IPv4메,메fragmentation메in메IPv6메is메performed메only메by메source메nodes메,메not메by메routers메along메a메packet메's메delivery메path메--메see메section메5메.메)메The메Fragment메header메is메identified메by메a메Next메Header메value메of메44메in메the메immediately메preceding메header메,메and메has메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Reserved메|메Fragment메Offset메|Res|M|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Identification메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Next메Header메8-bit메selector메.메Identifies메the메initial메header메type메of메the메Fragmentable메Part메of메the메original메packet메(메defined메below메)메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Reserved메8-bit메reserved메field메.메Initialized메to메zero메for메transmission메;메ignored메on메reception메.메Fragment메Offset메13-bit메unsigned메integer메.메The메offset메,메in메8-octet메units메,메of메the메data메following메this메header메,메relative메to메the메start메of메the메Fragmentable메Part메of메the메original메packet메.메Res메2-bit메reserved메field메.메Initialized메to메zero메for메transmission메;메ignored메on메reception메.메M메flag메1메=메more메fragments메;메0메=메last메fragment메.메Identification메32메bits메.메See메description메below메.메In메order메to메send메a메packet메that메is메too메large메to메fit메in메the메MTU메of메the메path메to메its메destination메,메a메source메node메may메divide메the메packet메into메fragments메and메send메each메fragment메as메a메separate메packet메,메to메be메reassembled메at메the메receiver메.메For메every메packet메that메is메to메be메fragmented메,메the메source메node메generates메an메Identification메value메.메The메Identification메must메be메different메than메that메of메any메other메fragmented메packet메sent메recently메*메with메the메same메Source메Address메and메Destination메Address메.메If메a메Routing메header메is메present메,메the메Destination메Address메of메concern메is메that메of메the메final메destination메.메*메``메recently메''메means메within메the메maximum메likely메lifetime메of메a메packet메,메including메transit메time메from메source메to메destination메and메time메spent메awaiting메reassembly메with메other메fragments메of메the메same메packet메.메However메,메it메is메not메required메that메a메source메node메know메the메maximum메packet메lifetime메.메Rather메,메it메is메assumed메that메the메requirement메can메be메met메by메maintaining메the메Identification메value메as메a메simple메,메32-메bit메,메``메wrap-around메''메counter메,메incremented메each메time메a메packet메must메be메fragmented메.메It메is메an메implementation메choice메whether메to메maintain메a메single메counter메for메the메node메or메multiple메counters메,메e.g.메,메one메for메each메of메the메node메's메possible메source메addresses메,메or메one메for메each메active메(메source메address메,메destination메address메)메combination메.메The메initial메,메large메,메unfragmented메packet메is메referred메to메as메the메``메original메packet메''메,메and메it메is메considered메to메consist메of메two메parts메,메as메illustrated메:메original메packet메:메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메//메--메--메--메--메--메--메--메--메--메--메--메-+메|메Unfragmentable메|메Fragmentable메|메|메Part메|메Part메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메//메--메--메--메--메--메--메--메--메--메--메--메-+메The메Unfragmentable메Part메consists메of메the메IPv6메header메plus메any메extension메headers메that메must메be메processed메by메nodes메en메route메to메the메destination메,메that메is메,메all메headers메up메to메and메including메the메Routing메header메if메present메,메else메the메Hop-by-Hop메Options메header메if메present메,메else메no메extension메headers메.메The메Fragmentable메Part메consists메of메the메rest메of메the메packet메,메that메is메,메any메extension메headers메that메need메be메processed메only메by메the메final메destination메node메(메s메)메,메plus메the메upper-layer메header메and메data메.메The메Fragmentable메Part메of메the메original메packet메is메divided메into메fragments메,메each메,메except메possibly메the메last메(메``메rightmost메''메)메one메,메being메an메integer메multiple메of메8메octets메long메.메The메fragments메are메transmitted메in메separate메``메fragment메packets메''메as메illustrated메:메original메packet메:메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메+메--메//메--메+메--메--메--메--메--메+메|메Unfragmentable메|메first메|메second메|메|메last메|메|메Part메|메fragment메|메fragment메|메....메|메fragment메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메+메--메//메--메+메--메--메--메--메--메+메fragment메packets메:메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메--메--메+메|메Unfragmentable메|Fragment|메first메|메|메Part메|메Header메|메fragment메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메--메--메+메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메--메--메+메|메Unfragmentable메|Fragment|메second메|메|메Part메|메Header메|메fragment메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메--메--메+메o메o메o메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메+메|메Unfragmentable메|Fragment|메last메|메|메Part메|메Header메|메fragment메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메+메--메--메--메--메--메+메Each메fragment메packet메is메composed메of메:메(메1메)메The메Unfragmentable메Part메of메the메original메packet메,메with메the메Payload메Length메of메the메original메IPv6메header메changed메to메contain메the메length메of메this메fragment메packet메only메(메excluding메the메length메of메the메IPv6메header메itself메)메,메and메the메Next메Header메field메of메the메last메header메of메the메Unfragmentable메Part메changed메to메44메.메(메2메)메A메Fragment메header메containing메:메The메Next메Header메value메that메identifies메the메first메header메of메the메Fragmentable메Part메of메the메original메packet메.메A메Fragment메Offset메containing메the메offset메of메the메fragment메,메in메8-octet메units메,메relative메to메the메start메of메the메Fragmentable메Part메of메the메original메packet메.메The메Fragment메Offset메of메the메first메(메``메leftmost메''메)메fragment메is메0메.메An메M메flag메value메of메0메if메the메fragment메is메the메last메(메``메rightmost메''메)메one메,메else메an메M메flag메value메of메1메.메The메Identification메value메generated메for메the메original메packet메.메(메3메)메The메fragment메itself메.메The메lengths메of메the메fragments메must메be메chosen메such메that메the메resulting메fragment메packets메fit메within메the메MTU메of메the메path메to메the메packets'메destination메(메s메)메.메At메the메destination메,메fragment메packets메are메reassembled메into메their메original메,메unfragmented메form메,메as메illustrated메:메reassembled메original메packet메:메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메//메--메--메--메--메--메--메--메--메--메--메--메--메+메|메Unfragmentable메|메Fragmentable메|메|메Part메|메Part메|메+메--메--메--메--메--메--메--메--메--메+메--메--메--메--메--메--메--메--메--메--메--메//메--메--메--메--메--메--메--메--메--메--메--메--메+메The메following메rules메govern메reassembly메:메An메original메packet메is메reassembled메only메from메fragment메packets메that메have메the메same메Source메Address메,메Destination메Address메,메and메Fragment메Identification메.메The메Unfragmentable메Part메of메the메reassembled메packet메consists메of메all메headers메up메to메,메but메not메including메,메the메Fragment메header메of메the메first메fragment메packet메(메that메is메,메the메packet메whose메Fragment메Offset메is메zero메)메,메with메the메following메two메changes메:메The메Next메Header메field메of메the메last메header메of메the메Unfragmentable메Part메is메obtained메from메the메Next메Header메field메of메the메first메fragment메's메Fragment메header메.메The메Payload메Length메of메the메reassembled메packet메is메computed메from메the메length메of메the메Unfragmentable메Part메and메the메length메and메offset메of메the메last메fragment메.메For메example메,메a메formula메for메computing메the메Payload메Length메of메the메reassembled메original메packet메is메:메PL.orig메=메PL.first메-메FL.first메-메8메+메(메8메*메FO.last메)메+메FL.last메where메PL.orig메=메Payload메Length메field메of메reassembled메packet메.메PL.first메=메Payload메Length메field메of메first메fragment메packet메.메FL.first메=메length메of메fragment메following메Fragment메header메of메first메fragment메packet메.메FO.last메=메Fragment메Offset메field메of메Fragment메header메of메last메fragment메packet메.메FL.last메=메length메of메fragment메following메Fragment메header메of메last메fragment메packet메.메The메Fragmentable메Part메of메the메reassembled메packet메is메constructed메from메the메fragments메following메the메Fragment메headers메in메each메of메the메fragment메packets메.메The메length메of메each메fragment메is메computed메by메subtracting메from메the메packet메's메Payload메Length메the메length메of메the메headers메between메the메IPv6메header메and메fragment메itself메;메its메relative메position메in메Fragmentable메Part메is메computed메from메its메Fragment메Offset메value메.메The메Fragment메header메is메not메present메in메the메final메,메reassembled메packet메.메The메following메error메conditions메may메arise메when메reassembling메fragmented메packets메:메If메insufficient메fragments메are메received메to메complete메reassembly메of메a메packet메within메60메seconds메of메the메reception메of메the메first-arriving메fragment메of메that메packet메,메reassembly메of메that메packet메must메be메abandoned메and메all메the메fragments메that메have메been메received메for메that메packet메must메be메discarded메.메If메the메first메fragment메(메i.e.메,메the메one메with메a메Fragment메Offset메of메zero메)메has메been메received메,메an메ICMP메Time메Exceeded메--메Fragment메Reassembly메Time메Exceeded메message메should메be메sent메to메the메source메of메that메fragment메.메If메the메length메of메a메fragment메,메as메derived메from메the메fragment메packet's메Payload메Length메field메,메is메not메a메multiple메of메8메octets메and메the메M메flag메of메that메fragment메is메1메,메then메that메fragment메must메be메discarded메and메an메ICMP메Parameter메Problem메,메Code메0메,메message메should메be메sent메to메the메source메of메the메fragment메,메pointing메to메the메Payload메Length메field메of메the메fragment메packet메.메If메the메length메and메offset메of메a메fragment메are메such메that메the메Payload메Length메of메the메packet메reassembled메from메that메fragment메would메exceed메65,535메octets메,메then메that메fragment메must메be메discarded메and메an메ICMP메Parameter메Problem메,메Code메0메,메message메should메be메sent메to메the메source메of메the메fragment메,메pointing메to메the메Fragment메Offset메field메of메the메fragment메packet메.메The메following메conditions메are메not메expected메to메occur메,메but메are메not메considered메errors메if메they메do메:메The메number메and메content메of메the메headers메preceding메the메Fragment메header메of메different메fragments메of메the메same메original메packet메may메differ메.메Whatever메headers메are메present메,메preceding메the메Fragment메header메in메each메fragment메packet메,메are메processed메when메the메packets메arrive메,메prior메to메queueing메the메fragments메for메reassembly메.메Only메those메headers메in메the메Offset메zero메fragment메packet메are메retained메in메the메reassembled메packet메.메The메Next메Header메values메in메the메Fragment메headers메of메different메fragments메of메the메same메original메packet메may메differ메.메Only메the메value메from메the메Offset메zero메fragment메packet메is메used메for메reassembly메.메4.6메Destination메Options메Header메The메Destination메Options메header메is메used메to메carry메optional메information메that메need메be메examined메only메by메a메packet메's메destination메node메(메s메)메.메The메Destination메Options메header메is메identified메by메a메Next메Header메value메of메60메in메the메immediately메preceding메header메,메and메has메the메following메format메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메+메|메|메.메.메.메Options메.메.메.메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Next메Header메8-bit메selector메.메Identifies메the메type메of메header메immediately메following메the메Destination메Options메header메.메Uses메the메same메values메as메the메IPv4메Protocol메field메[메RFC-1700메et메seq.메]메.메Hdr메Ext메Len메8-bit메unsigned메integer메.메Length메of메the메Destination메Options메header메in메8-octet메units메,메not메including메the메first메8메octets메.메Options메Variable-length메field메,메of메length메such메that메the메complete메Destination메Options메header메is메an메integer메multiple메of메8메octets메long메.메Contains메one메or메more메TLV-encoded메options메,메as메described메in메section메4.2메.메The메only메destination메options메defined메in메this메document메are메the메Pad1메and메PadN메options메specified메in메section메4.2메.메Note메that메there메are메two메possible메ways메to메encode메optional메destination메information메in메an메IPv6메packet메:메either메as메an메option메in메the메Destination메Options메header메,메or메as메a메separate메extension메header메.메The메Fragment메header메and메the메Authentication메header메are메examples메of메the메latter메approach메.메Which메approach메can메be메used메depends메on메what메action메is메desired메of메a메destination메node메that메does메not메understand메the메optional메information메:메o메if메the메desired메action메is메for메the메destination메node메to메discard메the메packet메and메,메only메if메the메packet메's메Destination메Address메is메not메a메multicast메address메,메send메an메ICMP메Unrecognized메Type메message메to메the메packet메's메Source메Address메,메then메the메information메may메be메encoded메either메as메a메separate메header메or메as메an메option메in메the메Destination메Options메header메whose메Option메Type메has메the메value메11메in메its메highest-order메two메bits메.메The메choice메may메depend메on메such메factors메as메which메takes메fewer메octets메,메or메which메yields메better메alignment메or메more메efficient메parsing메.메o메if메any메other메action메is메desired메,메the메information메must메be메encoded메as메an메option메in메the메Destination메Options메header메whose메Option메Type메has메the메value메00메,메01메,메or메10메in메its메highest-order메two메bits메,메specifying메the메desired메action메(메see메section메4.2메)메.메4.7메No메Next메Header메The메value메59메in메the메Next메Header메field메of메an메IPv6메header메or메any메extension메header메indicates메that메there메is메nothing메following메that메header메.메If메the메Payload메Length메field메of메the메IPv6메header메indicates메the메presence메of메octets메past메the메end메of메a메header메whose메Next메Header메field메contains메59메,메those메octets메must메be메ignored메,메and메passed메on메unchanged메if메the메packet메is메forwarded메.메5메.메Packet메Size메Issues메IPv6메requires메that메every메link메in메the메internet메have메an메MTU메of메576메octets메or메greater메.메On메any메link메that메can메not메convey메a메576-octet메packet메in메one메piece메,메link-specific메fragmentation메and메reassembly메must메be메provided메at메a메layer메below메IPv6메.메From메each메link메to메which메a메node메is메directly메attached메,메the메node메must메be메able메to메accept메packets메as메large메as메that메link메's메MTU메.메Links메that메have메a메configurable메MTU메(메for메example메,메PPP메links메[메RFC-1661메]메)메must메be메configured메to메have메an메MTU메of메at메least메576메octets메;메it메is메recommended메that메a메larger메MTU메be메configured메,메to메accommodate메possible메encapsulations메(메i.e.메,메tunneling메)메without메incurring메fragmentation메.메It메is메strongly메recommended메that메IPv6메nodes메implement메Path메MTU메Discovery메[메RFC-1191메]메,메in메order메to메discover메and메take메advantage메of메paths메with메MTU메greater메than메576메octets메.메However메,메a메minimal메IPv6메implementation메(메e.g.메,메in메a메boot메ROM메)메may메simply메restrict메itself메to메sending메packets메no메larger메than메576메octets메,메and메omit메implementation메of메Path메MTU메Discovery메.메In메order메to메send메a메packet메larger메than메a메path메's메MTU메,메a메node메may메use메the메IPv6메Fragment메header메to메fragment메the메packet메at메the메source메and메have메it메reassembled메at메the메destination메(메s메)메.메However메,메the메use메of메such메fragmentation메is메discouraged메in메any메application메that메is메able메to메adjust메its메packets메to메fit메the메measured메path메MTU메(메i.e.메,메down메to메576메octets메)메.메A메node메must메be메able메to메accept메a메fragmented메packet메that메,메after메reassembly메,메is메as메large메as메1500메octets메,메including메the메IPv6메header메.메A메node메is메permitted메to메accept메fragmented메packets메that메reassemble메to메more메than메1500메octets메.메However메,메a메node메must메not메send메fragments메that메reassemble메to메a메size메greater메than메1500메octets메unless메it메has메explicit메knowledge메that메the메destination메(메s메)메can메reassemble메a메packet메of메that메size메.메In메response메to메an메IPv6메packet메that메is메sent메to메an메IPv4메destination메(메i.e.메,메a메packet메that메undergoes메translation메from메IPv6메to메IPv4메)메,메the메originating메IPv6메node메may메receive메an메ICMP메Packet메Too메Big메message메reporting메a메Next-Hop메MTU메less메than메576메.메In메that메case메,메the메IPv6메node메is메not메required메to메reduce메the메size메of메subsequent메packets메to메less메than메576메,메but메must메include메a메Fragment메header메in메those메packets메so메that메the메IPv6-to-IPv4메translating메router메can메obtain메a메suitable메Identification메value메to메use메in메resulting메IPv4메fragments메.메Note메that메this메means메the메payload메may메have메to메be메reduced메to메528메octets메(메576메minus메40메for메the메IPv6메header메and메8메for메the메Fragment메header메)메,메and메smaller메still메if메additional메extension메headers메are메used메.메Note메:메Path메MTU메Discovery메must메be메performed메even메in메cases메where메a메host메``메thinks메''메a메destination메is메attached메to메the메same메link메as메itself메.메Note메:메Unlike메IPv4메,메it메is메unnecessary메in메IPv6메to메set메a메``메Don't메Fragment메''메flag메in메the메packet메header메in메order메to메perform메Path메MTU메Discovery메;메that메is메an메implicit메attribute메of메every메IPv6메packet메.메Also메,메those메parts메of메the메RFC-1191메procedures메that메involve메use메of메a메table메of메MTU메``메plateaus메''메do메not메apply메to메IPv6메,메because메the메IPv6메version메of메the메``메Datagram메Too메Big메''메message메always메identifies메the메exact메MTU메to메be메used메.메6메.메Flow메Labels메The메24-bit메Flow메Label메field메in메the메IPv6메header메may메be메used메by메a메source메to메label메those메packets메for메which메it메requests메special메handling메by메the메IPv6메routers메,메such메as메non-default메quality메of메service메or메``메real-time메''메service메.메This메aspect메of메IPv6메is메,메at메the메time메of메writing메,메still메experimental메and메subject메to메change메as메the메requirements메for메flow메support메in메the메Internet메become메clearer메.메Hosts메or메routers메that메do메not메support메the메functions메of메the메Flow메Label메field메are메required메to메set메the메field메to메zero메when메originating메a메packet메,메pass메the메field메on메unchanged메when메forwarding메a메packet메,메and메ignore메the메field메when메receiving메a메packet메.메A메flow메is메a메sequence메of메packets메sent메from메a메particular메source메to메a메particular메(메unicast메or메multicast메)메destination메for메which메the메source메desires메special메handling메by메the메intervening메routers메.메The메nature메of메that메special메handling메might메be메conveyed메to메the메routers메by메a메control메protocol메,메such메as메a메resource메reservation메protocol메,메or메by메information메within메the메flow메's메packets메themselves메,메e.g.메,메in메a메hop-by-hop메option메.메The메details메of메such메control메protocols메or메options메are메beyond메the메scope메of메this메document메.메There메may메be메multiple메active메flows메from메a메source메to메a메destination메,메as메well메as메traffic메that메is메not메associated메with메any메flow메.메A메flow메is메uniquely메identified메by메the메combination메of메a메source메address메and메a메non-zero메flow메label메.메Packets메that메do메not메belong메to메a메flow메carry메a메flow메label메of메zero메.메A메flow메label메is메assigned메to메a메flow메by메the메flow메's메source메node메.메New메flow메labels메must메be메chosen메(메pseudo-메)메randomly메and메uniformly메from메the메range메1메to메FFFFFF메hex메.메The메purpose메of메the메random메allocation메is메to메make메any메set메of메bits메within메the메Flow메Label메field메suitable메for메use메as메a메hash메key메by메routers메,메for메looking메up메the메state메associated메with메the메flow메.메All메packets메belonging메to메the메same메flow메must메be메sent메with메the메same메source메address메,메destination메address메,메priority메,메and메flow메label메.메If메any메of메those메packets메includes메a메Hop-by-Hop메Options메header메,메then메they메all메must메be메originated메with메the메same메Hop-by-Hop메Options메header메contents메(메excluding메the메Next메Header메field메of메the메Hop-by-Hop메Options메header메)메.메If메any메of메those메packets메includes메a메Routing메header메,메then메they메all메must메be메originated메with메the메same메contents메in메all메extension메headers메up메to메and메including메the메Routing메header메(메excluding메the메Next메Header메field메in메the메Routing메header메)메.메The메routers메or메destinations메are메permitted메,메but메not메required메,메to메verify메that메these메conditions메are메satisfied메.메If메a메violation메is메detected메,메it메should메be메reported메to메the메source메by메an메ICMP메Parameter메Problem메message메,메Code메0메,메pointing메to메the메high-order메octet메of메the메Flow메Label메field메(메i.e.메,메offset메1메within메the메IPv6메packet메)메.메Routers메are메free메to메``메opportunistically메''메set메up메flow-handling메state메for메any메flow메,메even메when메no메explicit메flow메establishment메information메has메been메provided메to메them메via메a메control메protocol메,메a메hop-by-hop메option메,메or메other메means메.메For메example메,메upon메receiving메a메packet메from메a메particular메source메with메an메unknown메,메non-zero메flow메label메,메a메router메may메process메its메IPv6메header메and메any메necessary메extension메headers메as메if메the메flow메label메were메zero메.메That메processing메would메include메determining메the메next-hop메interface메,메and메possibly메other메actions메,메such메as메updating메a메hop-by-hop메option메,메advancing메the메pointer메and메addresses메in메a메Routing메header메,메or메deciding메on메how메to메queue메the메packet메based메on메its메Priority메field메.메The메router메may메then메choose메to메``메remember메''메the메results메of메those메processing메steps메and메cache메that메information메,메using메the메source메address메plus메the메flow메label메as메the메cache메key메.메Subsequent메packets메with메the메same메source메address메and메flow메label메may메then메be메handled메by메referring메to메the메cached메information메rather메than메examining메all메those메fields메that메,메according메to메the메requirements메of메the메previous메paragraph메,메can메be메assumed메unchanged메from메the메first메packet메seen메in메the메flow메.메Cached메flow-handling메state메that메is메set메up메opportunistically메,메as메discussed메in메the메preceding메paragraph메,메must메be메discarded메no메more메than메6메seconds메after메it메is메established메,메regardless메of메whether메or메not메packets메of메the메same메flow메continue메to메arrive메.메If메another메packet메with메the메same메source메address메and메flow메label메arrives메after메the메cached메state메has메been메discarded메,메the메packet메undergoes메full메,메normal메processing메(메as메if메its메flow메label메were메zero메)메,메which메may메result메in메the메re-creation메of메cached메flow메state메for메that메flow메.메The메lifetime메of메flow-handling메state메that메is메set메up메explicitly메,메for메example메by메a메control메protocol메or메a메hop-by-hop메option메,메must메be메specified메as메part메of메the메specification메of메the메explicit메set-up메mechanism메;메it메may메exceed메6메seconds메.메A메source메must메not메re-use메a메flow메label메for메a메new메flow메within메the메lifetime메of메any메flow-handling메state메that메might메have메been메established메for메the메prior메use메of메that메flow메label메.메Since메flow-handling메state메with메a메lifetime메of메6메seconds메may메be메established메opportunistically메for메any메flow메,메the메minimum메interval메between메the메last메packet메of메one메flow메and메the메first메packet메of메a메new메flow메using메the메same메flow메label메is메6메seconds메.메Flow메labels메used메for메explicitly메set-up메flows메with메longer메flow-state메lifetimes메must메remain메unused메for메those메longer메lifetimes메before메being메re-used메for메new메flows메.메When메a메node메stops메and메restarts메(메e.g.메,메as메a메result메of메a메``메crash메''메)메,메it메must메be메careful메not메to메use메a메flow메label메that메it메might메have메used메for메an메earlier메flow메whose메lifetime메may메not메have메expired메yet메.메This메may메be메accomplished메by메recording메flow메label메usage메on메stable메storage메so메that메it메can메be메remembered메across메crashes메,메or메by메refraining메from메using메any메flow메labels메until메the메maximum메lifetime메of메any메possible메previously메established메flows메has메expired메(메at메least메6메seconds메;메more메if메explicit메flow메set-up메mechanisms메with메longer메lifetimes메might메have메been메used메)메.메If메the메minimum메time메for메rebooting메the메node메is메known메(메often메more메than메6메seconds메)메,메that메time메can메be메deducted메from메the메necessary메waiting메period메before메starting메to메allocate메flow메labels메.메There메is메no메requirement메that메all메,메or메even메most메,메packets메belong메to메flows메,메i.e.메,메carry메non-zero메flow메labels메.메This메observation메is메placed메here메to메remind메protocol메designers메and메implementors메not메to메assume메otherwise메.메For메example메,메it메would메be메unwise메to메design메a메router메whose메performance메would메be메adequate메only메if메most메packets메belonged메to메flows메,메or메to메design메a메header메compression메scheme메that메only메worked메on메packets메that메belonged메to메flows메.메7메.메Priority메The메4-bit메Priority메field메in메the메IPv6메header메enables메a메source메to메identify메the메desired메delivery메priority메of메its메packets메,메relative메to메other메packets메from메the메same메source메.메The메Priority메values메are메divided메into메two메ranges메:메Values메0메through메7메are메used메to메specify메the메priority메of메traffic메for메which메the메source메is메providing메congestion메control메,메i.e.메,메traffic메that메``메backs메off메''메in메response메to메congestion메,메such메as메TCP메traffic메.메Values메8메through메15메are메used메to메specify메the메priority메of메traffic메that메does메not메back메off메in메response메to메congestion메,메e.g.메,메``메real-time메''메packets메being메sent메at메a메constant메rate메.메For메congestion-controlled메traffic메,메the메following메Priority메values메are메recommended메for메particular메application메categories메:메0메-메uncharacterized메traffic메1메-메``메filler메''메traffic메(메e.g.메,메netnews메)메2메-메unattended메data메transfer메(메e.g.메,메email메)메3메-메(메reserved메)메4메-메attended메bulk메transfer메(메e.g.메,메FTP메,메NFS메)메5메-메(메reserved메)메6메-메interactive메traffic메(메e.g.메,메telnet메,메X메)메7메-메internet메control메traffic메(메e.g.메,메routing메protocols메,메SNMP메)메For메non-congestion-controlled메traffic메,메the메lowest메Priority메value메(메8메)메should메be메used메for메those메packets메that메the메sender메is메most메willing메to메have메discarded메under메conditions메of메congestion메(메e.g.메,메high-fidelity메video메traffic메)메,메and메the메highest메value메(메15메)메should메be메used메for메those메packets메that메the메sender메is메least메willing메to메have메discarded메(메e.g.메,메low-fidelity메audio메traffic메)메.메There메is메no메relative메ordering메implied메between메the메congestion-controlled메priorities메and메the메non-congestion-메controlled메priorities메.메8메.메Upper-Layer메Protocol메Issues메8.1메Upper-Layer메Checksums메Any메transport메or메other메upper-layer메protocol메that메includes메the메addresses메from메the메IP메header메in메its메checksum메computation메must메be메modified메for메use메over메IPv6메,메to메include메the메128-bit메IPv6메addresses메instead메of메32-bit메IPv4메addresses메.메In메particular메,메the메following메illustration메shows메the메TCP메and메UDP메``메pseudo-header메''메for메IPv6메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Source메Address메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메+메|메|메+메Destination메Address메+메|메|메+메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Payload메Length메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메zero메|메Next메Header메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메o메If메the메packet메contains메a메Routing메header메,메the메Destination메Address메used메in메the메pseudo-header메is메that메of메the메final메destination메.메At메the메originating메node메,메that메address메will메be메in메the메last메element메of메the메Routing메header메;메at메the메recipient메(메s메)메,메that메address메will메be메in메the메Destination메Address메field메of메the메IPv6메header메.메o메The메Next메Header메value메in메the메pseudo-header메identifies메the메upper-layer메protocol메(메e.g.메,메6메for메TCP메,메or메17메for메UDP메)메.메It메will메differ메from메the메Next메Header메value메in메the메IPv6메header메if메there메are메extension메headers메between메the메IPv6메header메and메the메upper-메layer메header메.메o메The메Payload메Length메used메in메the메pseudo-header메is메the메length메of메the메upper-layer메packet메,메including메the메upper-layer메header메.메It메will메be메less메than메the메Payload메Length메in메the메IPv6메header메(메or메in메the메Jumbo메Payload메option메)메if메there메are메extension메headers메between메the메IPv6메header메and메the메upper-layer메header메.메o메Unlike메IPv4메,메when메UDP메packets메are메originated메by메an메IPv6메node메,메the메UDP메checksum메is메not메optional메.메That메is메,메whenever메originating메a메UDP메packet메,메an메IPv6메node메must메compute메a메UDP메checksum메over메the메packet메and메the메pseudo-header메,메and메,메if메that메computation메yields메a메result메of메zero메,메it메must메be메changed메to메hex메FFFF메for메placement메in메the메UDP메header메.메IPv6메receivers메must메discard메UDP메packets메containing메a메zero메checksum메,메and메should메log메the메error메.메The메IPv6메version메of메ICMP메[메RFC-1885메]메includes메the메above메pseudo-header메in메its메checksum메computation메;메this메is메a메change메from메the메IPv4메version메of메ICMP메,메which메does메not메include메a메pseudo-header메in메its메checksum메.메The메reason메for메the메change메is메to메protect메ICMP메from메misdelivery메or메corruption메of메those메fields메of메the메IPv6메header메on메which메it메depends메,메which메,메unlike메IPv4메,메are메not메covered메by메an메internet-layer메checksum메.메The메Next메Header메field메in메the메pseudo-header메for메ICMP메contains메the메value메58메,메which메identifies메the메IPv6메version메of메ICMP메.메8.2메Maximum메Packet메Lifetime메Unlike메IPv4메,메IPv6메nodes메are메not메required메to메enforce메maximum메packet메lifetime메.메That메is메the메reason메the메IPv4메``메Time메to메Live메''메field메was메renamed메``메Hop메Limit메''메in메IPv6메.메In메practice메,메very메few메,메if메any메,메IPv4메implementations메conform메to메the메requirement메that메they메limit메packet메lifetime메,메so메this메is메not메a메change메in메practice메.메Any메upper-layer메protocol메that메relies메on메the메internet메layer메(메whether메IPv4메or메IPv6메)메to메limit메packet메lifetime메ought메to메be메upgraded메to메provide메its메own메mechanisms메for메detecting메and메discarding메obsolete메packets메.메8.3메Maximum메Upper-Layer메Payload메Size메When메computing메the메maximum메payload메size메available메for메upper-layer메data메,메an메upper-layer메protocol메must메take메into메account메the메larger메size메of메the메IPv6메header메relative메to메the메IPv4메header메.메For메example메,메in메IPv4메,메TCP메's메MSS메option메is메computed메as메the메maximum메packet메size메(메a메default메value메or메a메value메learned메through메Path메MTU메Discovery메)메minus메40메octets메(메20메octets메for메the메minimum-length메IPv4메header메and메20메octets메for메the메minimum-length메TCP메header메)메.메When메using메TCP메over메IPv6메,메the메MSS메must메be메computed메as메the메maximum메packet메size메minus메60메octets메,메because메the메minimum-length메IPv6메header메(메i.e.메,메an메IPv6메header메with메no메extension메headers메)메is메20메octets메longer메than메a메minimum-length메IPv4메header메.메Appendix메A.메Formatting메Guidelines메for메Options메This메appendix메gives메some메advice메on메how메to메lay메out메the메fields메when메designing메new메options메to메be메used메in메the메Hop-by-Hop메Options메header메or메the메Destination메Options메header메,메as메described메in메section메4.2메.메These메guidelines메are메based메on메the메following메assumptions메:메o메One메desirable메feature메is메that메any메multi-octet메fields메within메the메Option메Data메area메of메an메option메be메aligned메on메their메natural메boundaries메,메i.e.메,메fields메of메width메n메octets메should메be메placed메at메an메integer메multiple메of메n메octets메from메the메start메of메the메Hop-by-메Hop메or메Destination메Options메header메,메for메n메=메1메,메2메,메4메,메or메8.메o메Another메desirable메feature메is메that메the메Hop-by-Hop메or메Destination메Options메header메take메up메as메little메space메as메possible메,메subject메to메the메requirement메that메the메header메be메an메integer메multiple메of메8메octets메long메.메o메It메may메be메assumed메that메,메when메either메of메the메option-bearing메headers메are메present메,메they메carry메a메very메small메number메of메options메,메usually메only메one메.메These메assumptions메suggest메the메following메approach메to메laying메out메the메fields메of메an메option메:메order메the메fields메from메smallest메to메largest메,메with메no메interior메padding메,메then메derive메the메alignment메requirement메for메the메entire메option메based메on메the메alignment메requirement메of메the메largest메field메(메up메to메a메maximum메alignment메of메8메octets메)메.메This메approach메is메illustrated메in메the메following메examples메:메Example메1메If메an메option메X메required메two메data메fields메,메one메of메length메8메octets메and메one메of메length메4메octets메,메it메would메be메laid메out메as메follows메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Option메Type=X메|Opt메Data메Len=12|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메8-octet메field메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Its메alignment메requirement메is메8n+2메,메to메ensure메that메the메8-octet메field메starts메at메a메multiple-of-8메offset메from메the메start메of메the메enclosing메header메.메A메complete메Hop-by-Hop메or메Destination메Options메header메containing메this메one메option메would메look메as메follows메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len=1메|메Option메Type=X메|Opt메Data메Len=12|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메8-octet메field메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Example메2메If메an메option메Y메required메three메data메fields메,메one메of메length메4메octets메,메one메of메length메2메octets메,메and메one메of메length메1메octet메,메it메would메be메laid메out메as메follows메:메+-+-+-+-+-+-+-+-+메|메Option메Type=Y메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|Opt메Data메Len=7메|메1-octet메field메|메2-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Its메alignment메requirement메is메4n+3메,메to메ensure메that메the메4-octet메field메starts메at메a메multiple-of-4메offset메from메the메start메of메the메enclosing메header메.메A메complete메Hop-by-Hop메or메Destination메Options메header메containing메this메one메option메would메look메as메follows메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len=1메|메Pad1메Option=0메|메Option메Type=Y메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|Opt메Data메Len=7메|메1-octet메field메|메2-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메PadN메Option=1메|Opt메Data메Len=2메|메0메|메0메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Example메3메A메Hop-by-Hop메or메Destination메Options메header메containing메both메options메X메and메Y메from메Examples메1메and메2메would메have메one메of메the메two메following메formats메,메depending메on메which메option메appeared메first메:메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len=3메|메Option메Type=X메|Opt메Data메Len=12|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메8-octet메field메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메PadN메Option=1메|Opt메Data메Len=1메|메0메|메Option메Type=Y메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|Opt메Data메Len=7메|메1-octet메field메|메2-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메PadN메Option=1메|Opt메Data메Len=2메|메0메|메0메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메Next메Header메|메Hdr메Ext메Len=3메|메Pad1메Option=0메|메Option메Type=Y메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|Opt메Data메Len=7메|메1-octet메field메|메2-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메PadN메Option=1메|Opt메Data메Len=4메|메0메|메0메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메0메|메0메|메Option메Type=X메|Opt메Data메Len=12|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메4-octet메field메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메|메|메+메8-octet메field메+메|메|메+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+메Security메Considerations메This메document메specifies메that메the메IP메Authentication메Header메[메RFC-1826메]메and메the메IP메Encapsulating메Security메Payload메[메RFC-1827메]메be메used메with메IPv6메,메in메conformance메with메the메Security메Architecture메for메the메Internet메Protocol메[메RFC-1825메]메.메Acknowledgments메The메authors메gratefully메acknowledge메the메many메helpful메suggestions메of메the메members메of메the메IPng메working메group메,메the메End-to-End메Protocols메research메group메,메and메the메Internet메Community메At메Large메.메Authors메'메Addresses메Stephen메E.메Deering메Robert메M.메Hinden메Xerox메Palo메Alto메Research메Center메Ipsilon메Networks메,메Inc.메3333메Coyote메Hill메Road메2191메E.메Bayshore메Road메,메Suite메100메Palo메Alto메,메CA메94304메Palo메Alto메,메CA메94303메USA메USA메Phone메:메+1메415메812메4839메Phone메:메+1메415메846메4604메Fax메:메+1메415메812메4471메Fax메:메+1메415메855메1414메EMail메:메deering메@메parc.xerox.com메EMail메:메hinden메@메ipsilon.com메References메[메RFC-1825메]메Atkinson메,메R.메,메``메Security메Architecture메for메the메Internet메Protocol메''메,메RFC메1825메,메Naval메Research메Laboratory메,메August메1995메.메[메RFC-1826메]메Atkinson메,메R.메,메``메IP메Authentication메Header메''메,메RFC메1826메,메Naval메Research메Laboratory메,메August메1995메.메[메RFC-1827메]메Atkinson메,메R.메,메``메IP메Encapsulating메Security메Protocol메(메ESP메)메''메,메RFC메1827메,메Naval메Research메Laboratory메,메August메1995메.메[메RFC-1885메]메Conta메,메A.메,메and메S.메Deering메,메``메Internet메Control메Message메Protocol메(메ICMPv6메)메for메the메Internet메Protocol메Version메6메(메IPv6메)메Specification메''메,메RFC메1885메,메Digital메Equipment메Corporation메,메Xerox메PARC메,메December메1995메.메[메RFC-1884메]메Hinden메,메R.메,메and메S.메Deering메,메Editors메,메``메IP메Version메6메Addressing메Architecture메''메,메RFC메1884메,메Ipsilon메Networks메,메Xerox메PARC메,메December메1995메.메[메RFC-1191메]메Mogul메,메J.메,메and메S.메Deering메,메``메Path메MTU메Discovery메''메,메RFC메1191메,메DECWRL메,메Stanford메University메,메November메1990메.메[메RFC-791메]메Postel메,메J.메,메``메Internet메Protocol메''메,메STD메5메,메RFC메791메,메USC/Information메Sciences메Institute메,메September메1981메.메[메RFC-1700메]메Reynolds메,메J.메,메and메J.메Postel메,메``메Assigned메Numbers메''메,메STD메2메,메RFC메1700메,메USC/Information메Sciences메Institute메,메October메1994메.메[메RFC-1661메]메Simpson메,메W.메,메Editor메,메``메The메Point-to-Point메Protocol메(메PPP메)메''메,메STD메51메,메RFC메1661메,메Daydreamer메,메July메1994메.